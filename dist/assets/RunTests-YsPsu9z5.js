import{e as fe,g as je,d as p,f as ve,H as ye,j as e,s as L,k as Ce,l as y,n as Te,m as A,p as I,J as Se,K as we,a1 as H,a2 as W,O as Re,u as Pe,a as Ie,T as o,P,B as i,a3 as N,b as q,w as ne,Q as $e,D as Be,a4 as oe,a5 as ke}from"./index-sneoGVbn.js";import{C as Oe,a as Le,B as Ae}from"./BarChart-CDSpsVsB.js";import{C as ie,P as Me,T as Ee,a as ze,b as De,c as K,d as x,e as Fe,R as Ne,K as qe,f as Ke,g as _e,S as Ue,h as Ge}from"./ProgressBar-CA8T73A9.js";import{S as Ve}from"./SeverityChip-Bx0Gr4u9.js";import He from"axios";import{C as We}from"./Container-CZAdQrui.js";import{A as Xe,F as Je}from"./FormControlLabel-Ca3HQZZ1.js";import{G as h}from"./Grid-50O0GoJc.js";import{S as Qe}from"./Switch-u3d-cU2p.js";function Ye(r){return fe("MuiLinearProgress",r)}je("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const _=4,U=W`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,Ze=typeof U!="string"?H`
        animation: ${U} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,G=W`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,et=typeof G!="string"?H`
        animation: ${G} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,V=W`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,tt=typeof V!="string"?H`
        animation: ${V} 3s infinite linear;
      `:null,rt=r=>{const{classes:t,variant:a,color:u}=r,g={root:["root",`color${y(u)}`,a],dashed:["dashed",`dashedColor${y(u)}`],bar1:["bar","bar1",`barColor${y(u)}`,(a==="indeterminate"||a==="query")&&"bar1Indeterminate",a==="determinate"&&"bar1Determinate",a==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",a!=="buffer"&&`barColor${y(u)}`,a==="buffer"&&`color${y(u)}`,(a==="indeterminate"||a==="query")&&"bar2Indeterminate",a==="buffer"&&"bar2Buffer"]};return Te(g,Ye,t)},X=(r,t)=>r.vars?r.vars.palette.LinearProgress[`${t}Bg`]:r.palette.mode==="light"?Se(r.palette[t].main,.62):we(r.palette[t].main,.5),st=L("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(r,t)=>{const{ownerState:a}=r;return[t.root,t[`color${y(a.color)}`],t[a.variant]]}})(A(({theme:r})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(r.palette).filter(I()).map(([t])=>({props:{color:t},style:{backgroundColor:X(r,t)}})),{props:({ownerState:t})=>t.color==="inherit"&&t.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),at=L("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(r,t)=>{const{ownerState:a}=r;return[t.dashed,t[`dashedColor${y(a.color)}`]]}})(A(({theme:r})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(r.palette).filter(I()).map(([t])=>{const a=X(r,t);return{props:{color:t},style:{backgroundImage:`radial-gradient(${a} 0%, ${a} 16%, transparent 42%)`}}})]})),tt||{animation:`${V} 3s infinite linear`}),nt=L("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(r,t)=>{const{ownerState:a}=r;return[t.bar,t.bar1,t[`barColor${y(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&t.bar1Indeterminate,a.variant==="determinate"&&t.bar1Determinate,a.variant==="buffer"&&t.bar1Buffer]}})(A(({theme:r})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(r.palette).filter(I()).map(([t])=>({props:{color:t},style:{backgroundColor:(r.vars||r).palette[t].main}})),{props:{variant:"determinate"},style:{transition:`transform .${_}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${_}s linear`}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:{width:"auto"}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:Ze||{animation:`${U} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),ot=L("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(r,t)=>{const{ownerState:a}=r;return[t.bar,t.bar2,t[`barColor${y(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&t.bar2Indeterminate,a.variant==="buffer"&&t.bar2Buffer]}})(A(({theme:r})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(r.palette).filter(I()).map(([t])=>({props:{color:t},style:{"--LinearProgressBar2-barColor":(r.vars||r).palette[t].main}})),{props:({ownerState:t})=>t.variant!=="buffer"&&t.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:t})=>t.variant!=="buffer"&&t.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(r.palette).filter(I()).map(([t])=>({props:{color:t,variant:"buffer"},style:{backgroundColor:X(r,t),transition:`transform .${_}s linear`}})),{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:{width:"auto"}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:et||{animation:`${G} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),it=p.forwardRef(function(t,a){const u=ve({props:t,name:"MuiLinearProgress"}),{className:g,color:f="primary",value:l,valueBuffer:c,variant:m="indeterminate",...C}=u,j={...u,color:f,variant:m},v=rt(j),$=ye(),T={},S={bar1:{},bar2:{}};if((m==="determinate"||m==="buffer")&&l!==void 0){T["aria-valuenow"]=Math.round(l),T["aria-valuemin"]=0,T["aria-valuemax"]=100;let b=l-100;$&&(b=-b),S.bar1.transform=`translateX(${b}%)`}if(m==="buffer"&&c!==void 0){let b=(c||0)-100;$&&(b=-b),S.bar2.transform=`translateX(${b}%)`}return e.jsxs(st,{className:Ce(v.root,g),ownerState:j,role:"progressbar",...T,ref:a,...C,children:[m==="buffer"?e.jsx(at,{className:v.dashed,ownerState:j}):null,e.jsx(nt,{className:v.bar1,ownerState:j,style:S.bar1}),m==="determinate"?null:e.jsx(ot,{className:v.bar2,ownerState:j,style:S.bar2})]})}),lt="http://localhost:3001/api",le=He.create({baseURL:lt,headers:{"Content-Type":"application/json"}});le.interceptors.request.use(r=>{const t=localStorage.getItem("token");return t&&(r.headers.Authorization=`Bearer ${t}`),r},r=>Promise.reject(r));le.interceptors.response.use(r=>r,r=>{var a,u,g,f;const t={status:((a=r.response)==null?void 0:a.status)||500,message:((g=(u=r.response)==null?void 0:u.data)==null?void 0:g.message)||"Something went wrong",data:((f=r.response)==null?void 0:f.data)||{}};return Promise.reject(t)});const ct=async(r,t,a={})=>{try{await new Promise(c=>setTimeout(c,1e3));const g=Object.values(Re).flat().filter(c=>r.includes(c.id)),f={},l={};for(const c of g){await new Promise(v=>setTimeout(v,Math.random()*500+200));const m=Math.random()>.3,C=m?Math.random()*.3+.7:Math.random()*.5+.2,j=m?[]:["Improve model training with more diverse data.","Consider fine-tuning the model parameters.","Add more test cases to validation set."];f[c.id]={test:c,result:{pass:m,score:C,message:`Test ${m?"passed":"failed"} with score ${(C*100).toFixed(1)}%`,metrics:{score:C,evaluated_inputs:Math.floor(Math.random()*100)+50,processing_time:Math.random()*5+.5},details:{tested_with:a[c.id]||{},timestamp:new Date().toISOString()},recommendations:j,timestamp:new Date().toISOString()}},l[c.category]||(l[c.category]={passed:0,total:0}),l[c.category].total+=1,m&&(l[c.category].passed+=1)}return Promise.resolve({results:f,complianceScores:l})}catch(u){return Promise.reject(u)}},jt=()=>{const r=Pe(),{selectedTests:t,testParameters:a,modelAdapter:u,modelType:g,saveTestResults:f}=Ie(),[l,c]=p.useState(!1),[m,C]=p.useState(0),[j,v]=p.useState(""),[$,T]=p.useState({}),[S,b]=p.useState({}),[ce,J]=p.useState(0),[de,Q]=p.useState(0),[M,ue]=p.useState(0),[Y,Z]=p.useState(!1),[ee,te]=p.useState({}),[B,me]=p.useState(!1),[E,re]=p.useState([]),k=p.useRef(null),pe=()=>{const s={};return Object.entries(N).forEach(([n])=>{const d=t.filter(O=>{const w=Object.values(MOCK_TESTS).flat().find(D=>D.id===O);return w&&w.category===n});d.length>0&&(s[n]=d.length)}),s};p.useEffect(()=>{k.current&&B&&(k.current.scrollTop=k.current.scrollHeight)},[E,B]);const z=s=>{const n=new Date().toLocaleTimeString();re(d=>[...d,`[${n}] ${s}`])},se=async()=>{if(t.length){c(!0),C(0),v(""),T({}),b({}),J(0),Q(0),Z(!1),re([]),te({});try{z(`Starting test run for ${t.length} tests...`);const{results:s,complianceScores:n}=await ct(t,u,a);T(s),b(n);const d=Object.values(s).filter(R=>R.result.pass).length,O=t.length-d;J(d),Q(O);const ae=Object.values(n).reduce((R,F)=>R+F.passed,0),w=Object.values(n).reduce((R,F)=>R+F.total,0),D=w>0?ae/w*100:0;ue(D),f(s,n),v(""),c(!1),Z(!0),C(100),z(`Test run completed successfully. ${d} passed, ${O} failed.`)}catch(s){console.error("Error running tests:",s),z(`Error running tests: ${s.message}`),c(!1)}}},xe=s=>{te(n=>({...n,[s]:!n[s]}))},he=()=>{r("/results")},be=s=>typeof s=="number"?s.toFixed(2):s,ge=({item:s})=>e.jsxs(oe.Fragment,{children:[e.jsxs(K,{sx:{"& > *":{borderBottom:"unset"}},children:[e.jsx(x,{children:e.jsx(ke,{"aria-label":"expand row",size:"small",onClick:()=>xe(s.test.id),children:ee[s.test.id]?e.jsx(qe,{}):e.jsx(Ke,{})})}),e.jsx(x,{component:"th",scope:"row",children:s.test.name}),e.jsx(x,{children:e.jsx(_e,{category:s.test.category})}),e.jsx(x,{children:e.jsx(Ve,{severity:s.test.severity})}),e.jsx(x,{children:e.jsx(Ue,{status:s.result.pass?"passed":"failed"})}),e.jsx(x,{align:"right",children:e.jsx(ie,{score:s.result.score*100,size:36,showPercent:!1})})]}),e.jsx(K,{children:e.jsx(x,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:e.jsx(Ge,{in:ee[s.test.id],timeout:"auto",unmountOnExit:!0,children:e.jsxs(i,{sx:{margin:1,py:2},children:[e.jsx(o,{variant:"subtitle2",gutterBottom:!0,component:"div",children:"Test Details"}),e.jsxs(h,{container:!0,spacing:2,children:[e.jsxs(h,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"textSecondary",children:s.test.description}),s.result.metrics&&e.jsxs(i,{sx:{mt:2},children:[e.jsx(o,{variant:"subtitle2",gutterBottom:!0,children:"Metrics"}),e.jsx(i,{component:"dl",sx:{display:"grid",gridTemplateColumns:"auto 1fr",rowGap:"4px",columnGap:"8px"},children:Object.entries(s.result.metrics).map(([n,d])=>e.jsxs(oe.Fragment,{children:[e.jsxs(i,{component:"dt",sx:{fontWeight:"bold",color:"text.secondary"},children:[n.replace(/_/g," "),":"]}),e.jsx(i,{component:"dd",sx:{m:0},children:be(d)})]},n))})]})]}),e.jsx(h,{item:!0,xs:12,md:6,children:s.result.recommendations&&s.result.recommendations.length>0&&e.jsxs(i,{children:[e.jsx(o,{variant:"subtitle2",gutterBottom:!0,children:"Recommendations"}),e.jsx(i,{component:"ul",sx:{m:0,pl:2,"& li":{mb:1}},children:s.result.recommendations.map((n,d)=>e.jsx("li",{children:e.jsx(o,{variant:"body2",children:n})},d))})]})})]})]})})})})]});return e.jsxs(We,{maxWidth:"lg",children:[e.jsx(o,{variant:"h4",gutterBottom:!0,children:"Run Compliance Tests"}),t.length===0?e.jsx(Xe,{severity:"warning",sx:{mb:3},children:"No tests have been selected. Please go back to Test Configuration to select tests."}):e.jsxs(P,{sx:{p:3,mb:3},children:[e.jsxs(i,{sx:{mb:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Test Summary"}),e.jsx(h,{container:!0,spacing:2,children:Object.entries(pe()).map(([s,n])=>e.jsx(h,{item:!0,xs:6,sm:4,md:3,children:e.jsxs(P,{elevation:0,sx:{p:2,bgcolor:"rgba(0,0,0,0.03)",borderRadius:2,border:"1px solid rgba(0,0,0,0.08)"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(i,{sx:{width:10,height:10,borderRadius:"50%",bgcolor:N[s]||"#757575",mr:1}}),e.jsx(o,{variant:"body2",children:s})]}),e.jsx(o,{variant:"h5",sx:{mt:1,fontWeight:"medium"},children:n})]})},s))})]}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(Je,{control:e.jsx(Qe,{checked:B,onChange:s=>me(s.target.checked),disabled:l}),label:"Verbose Logging"}),e.jsx(q,{variant:"contained",color:"primary",startIcon:l?e.jsx(ne,{size:20,color:"inherit"}):e.jsx($e,{}),onClick:se,disabled:l,children:l?"Running Tests...":"Run Tests"})]}),(l||Y)&&e.jsxs(i,{sx:{mb:3},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[e.jsx(o,{variant:"body2",children:l?`Running: ${j}`:"Test Run Completed"}),e.jsxs(o,{variant:"body2",children:[Math.round(m),"%"]})]}),e.jsx(it,{variant:"determinate",value:m,sx:{height:10,borderRadius:1}})]}),B&&(E.length>0||l)&&e.jsxs(i,{ref:k,sx:{maxHeight:200,overflowY:"auto",p:2,bgcolor:"rgba(0,0,0,0.03)",borderRadius:1,fontFamily:"monospace",fontSize:13,mb:2},children:[E.map((s,n)=>e.jsx(i,{sx:{mb:.5},children:s},n)),l&&e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{size:14,sx:{mr:1}}),"Processing..."]})]}),Y&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{sx:{my:3}}),e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Test Results Summary"}),e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsxs(P,{sx:{p:2,textAlign:"center"},children:[e.jsx(o,{variant:"body2",color:"textSecondary",children:"Total Tests"}),e.jsx(o,{variant:"h4",children:t.length})]})}),e.jsx(h,{item:!0,xs:6,sm:4,children:e.jsxs(P,{sx:{p:2,textAlign:"center",bgcolor:"rgba(76, 175, 80, 0.1)"},children:[e.jsx(o,{variant:"body2",color:"success.main",children:"Tests Passed"}),e.jsx(o,{variant:"h4",color:"success.main",children:ce})]})}),e.jsx(h,{item:!0,xs:6,sm:4,children:e.jsxs(P,{sx:{p:2,textAlign:"center",bgcolor:"rgba(244, 67, 54, 0.1)"},children:[e.jsx(o,{variant:"body2",color:"error.main",children:"Tests Failed"}),e.jsx(o,{variant:"h4",color:"error.main",children:de})]})})]}),e.jsxs(i,{sx:{mt:3,p:3,borderRadius:2,bgcolor:"rgba(0,0,0,0.03)",textAlign:"center"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Overall Compliance Score"}),e.jsx(ie,{score:M,size:120,label:M>=80?"Excellent compliance level":M>=50?"Moderate compliance level":"Low compliance level",sx:{mb:1}})]}),e.jsx(o,{variant:"h6",sx:{mt:4,mb:2},children:"Results by Category"}),e.jsx(h,{container:!0,spacing:3,children:Object.entries(S).map(([s,n])=>{const d=n.total>0?n.passed/n.total*100:0;return e.jsx(h,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Oe,{children:e.jsxs(Le,{children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(i,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:N[s]||"#757575",mr:1}}),e.jsx(o,{variant:"subtitle1",children:s})]}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(o,{variant:"body2",color:"textSecondary",children:["Passed: ",n.passed,"/",n.total]}),e.jsxs(o,{variant:"h6",sx:{color:d>=80?"success.main":d>=50?"warning.main":"error.main"},children:[d.toFixed(1),"%"]})]}),e.jsx(Me,{value:d,sx:{mt:1}})]})})},s)})}),e.jsx(o,{variant:"h6",sx:{mt:4,mb:2},children:"Detailed Test Results"}),e.jsx(Ee,{children:e.jsxs(ze,{"aria-label":"test results table",children:[e.jsx(De,{children:e.jsxs(K,{children:[e.jsx(x,{width:50}),e.jsx(x,{children:"Test Name"}),e.jsx(x,{width:140,children:"Category"}),e.jsx(x,{width:100,children:"Severity"}),e.jsx(x,{width:100,children:"Status"}),e.jsx(x,{width:80,align:"right",children:"Score"})]})}),e.jsx(Fe,{children:Object.values($).map(s=>e.jsx(ge,{item:s},s.test.id))})]})}),e.jsxs(i,{sx:{mt:3,display:"flex",justifyContent:"space-between"},children:[e.jsx(q,{variant:"outlined",startIcon:e.jsx(Ne,{}),onClick:se,children:"Run Tests Again"}),e.jsx(q,{variant:"contained",color:"primary",startIcon:e.jsx(Ae,{}),onClick:he,children:"View Complete Results"})]})]})]})]})};export{jt as default};
//# sourceMappingURL=RunTests-YsPsu9z5.js.map
